<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Join SG Best Food - Partner With Us</title>
    <link rel="stylesheet" href="styles/main.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        .join-section {
            padding: 6rem 2rem;
            background: linear-gradient(135deg, #fff5f5 0%, #fff 100%);
            min-height: calc(100vh - 80px);
        }

        .join-content {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 3rem;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .join-header {
            text-align: center;
            margin-bottom: 3rem;
        }

        .join-header h1 {
            font-size: 2.5rem;
            color: var(--text-dark);
            margin-bottom: 1rem;
        }

        .join-header p {
            color: var(--text-light);
            font-size: 1.1rem;
            line-height: 1.6;
        }

        .package-details {
            background: #f8f9fa;
            padding: 2rem;
            border-radius: 15px;
            margin-bottom: 2rem;
        }

        .package-details h2 {
            color: var(--primary-color);
            margin-bottom: 1rem;
            font-size: 1.8rem;
        }

        .benefits-list {
            list-style: none;
            padding: 0;
        }

        .benefits-list li {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1rem;
            padding: 0.5rem;
            border-radius: 8px;
        }

        .benefits-list li i {
            color: var(--primary-color);
            font-size: 1.2rem;
        }

        .join-form {
            margin-top: 2rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: var(--text-dark);
        }

        .form-group input {
            width: 100%;
            padding: 0.8rem;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
        }

        .form-group input:focus {
            border-color: var(--primary-color);
            outline: none;
            box-shadow: 0 0 0 3px rgba(231, 76, 60, 0.1);
        }

        .submit-section {
            text-align: center;
            margin-top: 2rem;
        }

        .price-tag {
            display: inline-block;
            background: var(--primary-color);
            color: white;
            padding: 0.5rem 1.5rem;
            border-radius: 25px;
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 1rem;
        }

        #paypal-button-container {
            max-width: 300px;
            margin: 1rem auto;
        }

        .payment-options {
            display: flex;
            gap: 2rem;
            margin-top: 2rem;
            justify-content: center;
        }

        .payment-option {
            flex: 1;
            max-width: 300px;
            padding: 2rem;
            border: 2px solid #ddd;
            border-radius: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .payment-option:hover {
            border-color: var(--primary-color);
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .payment-option h3 {
            font-size: 1.5rem;
            margin-bottom: 1rem;
            color: var(--text-dark);
        }

        .payment-option .price {
            font-size: 2rem;
            font-weight: bold;
            color: var(--primary-color);
            margin-bottom: 0.5rem;
        }

        .payment-option .save-tag {
            background: #2ecc71;
            color: white;
            padding: 0.3rem 1rem;
            border-radius: 15px;
            display: inline-block;
            font-weight: bold;
            margin-bottom: 1rem;
        }

        .payment-option .cancel-text {
            color: var(--text-light);
            font-size: 0.9rem;
            margin-bottom: 1rem;
        }

        @media (max-width: 768px) {
            .payment-options {
                flex-direction: column;
                align-items: center;
            }

            .payment-option {
                width: 100%;
            }
        }

        .payment-option.active {
            border-color: var(--primary-color);
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .gst-notice {
            color: var(--text-light);
            font-size: 0.9rem;
            margin-top: 0.5rem;
            font-style: italic;
        }

        .qr-code-section {
            margin-top: 1rem;
            text-align: center;
        }

        .qr-code-section img {
            max-width: 150px;
            margin: 0.5rem auto;
        }

        .qr-code-section p {
            color: var(--text-light);
            font-size: 0.9rem;
            margin-top: 0.5rem;
        }

        .divider {
            margin: 1rem 0;
            text-align: center;
            position: relative;
        }

        .divider::before {
            content: "";
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 1px;
            background: #ddd;
        }

        .divider span {
            background: white;
            padding: 0 1rem;
            color: var(--text-light);
            position: relative;
            font-size: 0.9rem;
        }

        .paypal-direct-link {
            display: block;
            text-align: center;
            margin: 1rem 0;
            text-decoration: none;
        }

        .paypal-direct-link img {
            max-width: 200px;
            height: auto;
        }

        .paypal-direct-link:hover {
            opacity: 0.9;
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar scrolled">
        <div class="nav-brand">
            <a href="index.html">SG Best Food</a>
        </div>
        <div class="nav-links">
            <a href="index.html">Home</a>
            <a href="index.html#about">About</a>
            <a href="index.html#contact">Contact</a>
        </div>
    </nav>

    <!-- Join Section -->
    <section class="join-section">
        <div class="join-content">
            <div class="join-header">
                <h1>Join SG Best Food</h1>
                <p>Partner with us to boost your restaurant's visibility and reach thousands of potential customers.</p>
            </div>

            <div class="package-details">
                <h2>Premium Partner Package</h2>
                <ul class="benefits-list">
                    <li><i class="fas fa-crown"></i> Premium listing position on our platform</li>
                    <li><i class="fas fa-calendar-check"></i> Easy booking system for your customers</li>
                    <li><i class="fas fa-users"></i> Access to 1,500+ daily visitors</li>
                    <li><i class="fab fa-google"></i> Enhanced exposure through Google Ads</li>
                    <li><i class="fas fa-star"></i> Equal exposure opportunity with branded restaurants</li>
                </ul>
            </div>

            <form id="partner-form" class="join-form">
                <div class="form-group">
                    <label for="restaurant-name">Restaurant Name*</label>
                    <input type="text" id="restaurant-name" required>
                </div>
                <div class="form-group">
                    <label for="contact-name">Contact Person Name*</label>
                    <input type="text" id="contact-name" required>
                </div>
                <div class="form-group">
                    <label for="email">Email Address*</label>
                    <input type="email" id="email" required>
                </div>
                <div class="form-group">
                    <label for="phone">Contact Phone*</label>
                    <input type="tel" id="phone" required>
                </div>
                <div class="form-group">
                    <label for="website">Restaurant Website</label>
                    <input type="url" id="website" placeholder="https://example.com">
                </div>
                <div class="form-group">
                    <label for="google-link">Google Maps Link</label>
                    <input type="url" id="google-link" placeholder="https://www.google.com/maps/...">
                </div>

                <div class="payment-options">
                    <div class="payment-option yearly" onclick="selectPaymentOption('yearly')">
                        <h3>Pay Yearly</h3>
                        <div class="price">$350</div>
                        <div class="save-tag">Save $154!</div>
                        <div class="gst-notice">Price is excluded 9% GST</div>
                        <div class="paypal-button-container" style="display: none;">
                            <a href="https://www.paypal.com/ncp/payment/EKZWS9HZM7JF4" class="paypal-direct-link" target="_blank" onclick="return validateFormBeforePayment(event)">
                                <img src="https://www.paypalobjects.com/webstatic/en_US/i/buttons/buy-logo-large.png" alt="Pay with PayPal" />
                            </a>
                            <div class="divider">
                                <span>or scan to pay</span>
                            </div>
                            <div class="qr-code-section">
                                <img src="./images/paypal-qr.png" alt="PayPal QR Code Payment" 
                                     onerror="handleQRCodeError(this)"
                                     onload="console.log('QR code loaded successfully:', this.src);">
                                <p>Scan with your mobile device to pay</p>
                            </div>
                        </div>
                    </div>
                    <div class="payment-option monthly" onclick="selectPaymentOption('monthly')">
                        <h3>Pay Monthly</h3>
                        <div class="price">$42/month</div>
                        <div class="cancel-text">Cancel anytime</div>
                        <div class="gst-notice">Price is excluded 9% GST</div>
                        <div class="paypal-button-container" style="display: none;">
                            <div id="paypal-button-container-P-0XW615804V1296820M6W2G4Y"></div>
                        </div>
                    </div>
                </div>
            </form>
        </div>
    </section>

    <!-- Footer -->
    <footer>
        <div class="footer-content">
            <div class="footer-section">
                <h3>About SG Best Food</h3>
                <p>Your trusted platform for discovering and reviewing the best restaurants in Singapore.</p>
            </div>
            <div class="footer-section">
                <h3>Quick Links</h3>
                <ul>
                    <li><a href="index.html#about">About Us</a></li>
                    <li><a href="index.html#contact">Contact</a></li>
                    <li><a href="#privacy">Privacy Policy</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h3>Contact Info</h3>
                <ul class="contact-info">
                    <li><i class="fas fa-envelope"></i> sgbestfoodplatform@gmail.com</li>
                    <li><i class="fas fa-phone"></i> +65 80271780</li>
                    <li><i class="fas fa-map-marker-alt"></i> Clarke Quay, Singapore</li>
                </ul>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2024 SG Best Food. All rights reserved.</p>
        </div>
    </footer>

    <!-- Replace the PayPal script tag with one that only includes needed components -->
    <script src="https://www.paypal.com/sdk/js?client-id=AcQq7vIblkzfjRS7iSkd85poMDZvczYHr-YSZUmDj-zIWWQv4IqDUFiDDEr2oL1gpsylMcXs1elncQAD&vault=true&intent=subscription&components=buttons&currency=SGD"></script>

    <script>
        // Define error handling functions first
        function handleQRCodeError(img) {
            console.error('Failed to load QR code:', img.src);
            img.style.display = 'none';
            img.nextElementSibling.style.display = 'none';
            const errorMessage = document.createElement('p');
            errorMessage.style.color = '#e74c3c';
            errorMessage.textContent = 'QR code payment option temporarily unavailable';
            img.parentElement.appendChild(errorMessage);
        }

        function validateFormBeforePayment(event) {
            if (!validateForm()) {
                event.preventDefault();
                return false;
            }
            return true;
        }

        function validateForm() {
            const form = document.getElementById('partner-form');
            const requiredFields = form.querySelectorAll('[required]');
            
            for (let field of requiredFields) {
                if (!field.value) {
                    alert('Please fill in all required fields before proceeding with payment.');
                    field.focus();
                    return false;
                }
            }
            return true;
        }

        document.addEventListener('DOMContentLoaded', function() {
            const form = document.getElementById('partner-form');
            
            // Initialize Monthly Subscription Button only
            if (paypal.Buttons) {
                paypal.Buttons({
                    style: {
                        shape: 'rect',
                        color: 'gold',
                        layout: 'vertical',
                        label: 'subscribe'
                    },
                    createSubscription: function(data, actions) {
                        if (!validateForm()) {
                            return false;
                        }
                        return actions.subscription.create({
                            plan_id: 'P-0XW615804V1296820M6W2G4Y'
                        });
                    },
                    onApprove: async function(data, actions) {
                        await sendFormData('monthly', data.subscriptionID);
                    }
                }).render('#paypal-button-container-P-0XW615804V1296820M6W2G4Y');
            }
        });

        function selectPaymentOption(option) {
            // Get both PayPal button containers
            const monthlyContainer = document.querySelector('.payment-option.monthly .paypal-button-container');
            const yearlyContainer = document.querySelector('.payment-option.yearly .paypal-button-container');
            
            // Hide both containers first
            if (monthlyContainer) monthlyContainer.style.display = 'none';
            if (yearlyContainer) yearlyContainer.style.display = 'none';
            
            // Show selected option's container
            if (option === 'monthly' && monthlyContainer) {
                monthlyContainer.style.display = 'block';
            } else if (option === 'yearly' && yearlyContainer) {
                yearlyContainer.style.display = 'block';
            }

            // Update active state
            document.querySelectorAll('.payment-option').forEach(opt => {
                opt.classList.remove('active');
            });
            document.querySelector(`.payment-option.${option}`).classList.add('active');
        }

        async function sendFormData(planType, paymentId) {
            const formData = {
                restaurantName: document.getElementById('restaurant-name').value,
                contactName: document.getElementById('contact-name').value,
                email: document.getElementById('email').value,
                phone: document.getElementById('phone').value,
                website: document.getElementById('website').value,
                googleLink: document.getElementById('google-link').value,
                planType: planType,
                paymentId: paymentId
            };

            try {
                const response = await fetch('/api/partner-signup', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(formData)
                });

                if (!response.ok) {
                    throw new Error('Failed to submit form');
                }
            } catch (error) {
                console.error('Error submitting form:', error);
            }
        }
    </script>
</body>
</html> 